## Android App 出海引流那些事


#### 背景

App 要发展，首先面临的第一关就是用户数，也就是我们说的 DAU。而要做大 DAU，除了遇上风口，通过口碑相传，更多的时候，涉及到流量推广。


首先我们说说国内：

1. 国内应用市场推广：给360手机助手或腾讯应用宝，让他们去排首焦，带来安装，按渠道包的付费。
2. 国内广告平台如：```http://waps.cn/```，```https://www.youmi.net/```更有我们自己的平台 ```www.alimama.com``` 等这类广告平台。有以下几种广形式
   * Banner 广告
   * 插屏广告
   * 积分墙
   * 视频播放类
按安装付费，一次安装，1.5元左右的成本。

3. 系统预装，直接找小米，华为去做系统预装，来拿到大量的新设备和新用户。
4. 另外还有如 SNS 的运营方式，如支付宝PC 转帐要钱，客户端下单更优惠等运营方式来引导安装。

而我们地处国际化，和国内的环境又有些不同。

* 国外只有Google Play应用市场，不像国内应用市场鱼龙混杂的状态。国内的给钱去排首焦行不通。
* 国外的广告平台只有 facebook[人群划分] 和 adwords.
* 系统预装还是可以做的。
* SNS 分享运营和国内也几乎无差。

所以，通过比较，主要的不同点主要在应用市场的推广和广告平台的使用上。

#### 技术方案

基于上述背景，我们要获得更多的用户，就必须按照 Play 的玩法来。

1. 按 Play 的规范和设计来开发，赢得用户喜爱并获得 Google 认可。
   * [AE Android 编辑精选之路](https://www.atatech.org/articles/86421)
2. 使用 Google Play的引流方式
   * [Android 站外引流激活技术方案](https://www.atatech.org/articles/33932) 不管是单 APK 还是 Play 的玩法，都支持。

3. Facebook 和 admob广告投放
   * [admob](https://apps.admob.com/v2/home)

4. 广告投放的优化和省钱方案
   * [无线App导流推广最优方案](https://www.atatech.org/articles/89631)   通过实现applinks，来达到一个广告点击，两份收获的效果。

   
#### App引流的意义
* 要明白，引流真正的意义：除了带来真正的设备激活外，我们还要求必须去 Play 查看 App 详情，通过 Play 下载。【这很重要】
* 因为每一个引到 Play 去浏览和下载 App 的行为，都会对 Play 产生正面影响，让Play 给我们更多的搜索权重，以带来除下载安装之外的红利！【这更重要！】


#### 流量作弊

通用 App 引流的架构图如下：
![流量投放.jpg](http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/9ccf74fd1cf0eddddd51c7743067a8f6.jpg)

1. 每一次点击都生成一个点击 ID，用于后期数据归因，所以要作弊，第一个阶段，就是获取到302跳转的 URL，得到referrer.
2. 得到referrer后，发送可以分为两种
   * 直接在单台设备上 adb shell 发送，需要有多台设备，多个 IP，甚至 Root 机器，每次得到不同的 IMEI 以及屏幕大小等。
   * 第二种，流量劫持，发布应用让用户去下载，并在后台不停请求点击服务器获取得最新的点击 ID，然后不停发送系统广播，达到作弊。这种情况，自然流量，从 FaceBook 引过来的流量，从adwords引过来的流量，都会被覆盖成这个渠道带来的流量，造成的影响是：本来是免费的用户，我们给渠道付了一份钱；本来是通过付费点击得过来的用户，我们又付给渠道一份钱。

十足的恶人！那我们怎么防？


#### 流量反作弊

1. 人在做，云在算，大数据时代，反作弊平台可以根据以下特征去抓取：
   * clickId生成时间和这个clickId上报激活时间差，如果小于5秒，代表是作弊。
   * 一个 clickId 对应多台设备的时候，就是作弊。
   * 一台设备循环多次请求激活接口就是作弊。
   * 根据集团 UMIDtoken进行设备去重。

2. 客户端的方案。
   * 弃用原来的[ReferrerReceiver的方案](https://developers.google.com/android/reference/com/google/android/gms/tagmanager/InstallReferrerReceiver) 改用: [InstallReferrer aidl get](https://developer.android.com/google/play/installreferrer/library.html#dependencies) 通过调用 Google Play 的 Referrer 获取 AIDL 接口，得到真正的 Referrer，防止作弊。

   

#### 数据监控

* 日应安装，日安装成功，日安装失败。
* 日应激活，日激活成功，日激活失败。
* 日 PPC 应激活，日PPC激活成功，日激活失败。
* 激活接口调用成功和失败的监控。


#### 数据找回和核对

因为涉及到激活，就是钱，所以在技术方案的实施上，必须是双保险。要保证所有传给服务端归因的数据，通过另一种方式也实现一份，比如：adid和 referrer， 这个时候，这两个数据，也同样打点到 WDM 平台上，用于数据异常时的数据恢复。

涉及以下数据：

* 日应安装，日安装成功，日安装失败。
* 日应激活，日激活成功，日激活失败。
* 日 PPC 应激活，日PPC激活成功，日激活失败。

可以和上面的数据监控放在一起，监控数据就是找回数据的数据源。


#### 一些备注

* 要明白商业的真正的意义，我们不仅仅要激活设备，还要引导到 Google Play 去下载去安装。
* 涉及到金钱的系统，监控打点一定要全。
* 两条脚走路，双备份，双容灾，保证有数据可对，有数据可查。

   





